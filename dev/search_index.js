var documenterSearchIndex = {"docs":
[{"location":"api/","page":"API","title":"API","text":"CurrentModule = RefinedSlippage","category":"page"},{"location":"api/#API-Reference","page":"API","title":"API Reference","text":"","category":"section"},{"location":"api/","page":"API","title":"API","text":"Pages = [\"api.md\"]","category":"page"},{"location":"api/#Main-Types","page":"API","title":"Main Types","text":"","category":"section"},{"location":"api/","page":"API","title":"API","text":"ExecutionData","category":"page"},{"location":"api/#RefinedSlippage.ExecutionData","page":"API","title":"RefinedSlippage.ExecutionData","text":"ExecutionData\n\nContainer for all data needed for execution analysis.\n\n# Fields\n- `fills::DataFrame`: Fill data with columns `:time`, `:quantity`, `:price`, `:execution_name`, `:asset`\n- `metadata::DataFrame`: Execution metadata with columns `:execution_name`, `:side`, `:desired_quantity`, (optional: `:arrival_price`)\n- `tob::DataFrame`: Top-of-book prices with columns `:time`, `:symbol`, `:bid_price`, `:ask_price`\n- `volume::Union{Missing,DataFrame}`: Optional market volume data with columns `:time_from`, `:time_to`, `:symbol`, `:volume` for vs_vwap calculation. Market VWAP is estimated using TOB mid-prices weighted by volume.\n- `peers::Union{Missing,DataFrame}`: Optional peer weights with columns `:execution_name`, `:peer`, `:weight`\n- `vols::Union{Missing,DataFrame}`: Optional volatilities with columns `:asset`, `:volatility` (hourly vol)\n- `peer_return_truncation::Float64`: Truncation threshold for peer returns (in multiples of volatility). Default 2.0, use Inf to disable.\n- `fill_returns::Union{Missing,DataFrame}`: Computed by `calculate_slippage!`, contains fill-level data with counterfactual prices\n- `summary_bps::Union{Missing,DataFrame}`: Computed by `calculate_slippage!`, slippage summary in basis points\n- `summary_pct::Union{Missing,DataFrame}`: Computed by `calculate_slippage!`, slippage summary in percentage points\n- `summary_usd::Union{Missing,DataFrame}`: Computed by `calculate_slippage!`, slippage summary in USD\n\n# Constructors\n```julia\n# Without peers (classical slippage only)\ndata = ExecutionData(fills_df, metadata_df, bidask_df; volume=volume_df)\n\n# With user-provided peers (optional vols for truncation)\ndata = ExecutionData(fills_df, metadata_df, bidask_df, peers_df; volume=volume_df, vols=vols_df, peer_return_truncation=2.0)\n\n# With automatic peer calculation from covariance matrix\ndata = ExecutionData(fills_df, metadata_df, bidask_df, covar; volume=volume_df, num_peers=4, peer_return_truncation=2.0)\n```\n\n\n\n\n\n","category":"type"},{"location":"api/#Slippage-Calculation","page":"API","title":"Slippage Calculation","text":"","category":"section"},{"location":"api/","page":"API","title":"API","text":"calculate_slippage!\nget_slippage!","category":"page"},{"location":"api/#RefinedSlippage.calculate_slippage!","page":"API","title":"RefinedSlippage.calculate_slippage!","text":"calculate_slippage!(exec_data::ExecutionData)\n\nCalculate slippage metrics and store results in exec_data.summary_bps, exec_data.summary_pct, exec_data.summary_usd, and exec_data.fill_returns.\n\nIf exec_data.peers is provided, calculates both classical and refined slippage. If exec_data.volume is provided, calculates vsvwap slippage (fill VWAP vs market VWAP). If `execdata.peers` is missing, calculates only classical slippage.\n\nUse get_slippage!(exec_data, :bps) to retrieve the desired format.\n\nReturns\n\nexec_data: The modified ExecutionData with summary and fill_returns populated.\n\n\n\n\n\n","category":"function"},{"location":"api/#RefinedSlippage.get_slippage!","page":"API","title":"RefinedSlippage.get_slippage!","text":"get_slippage!(exec_data::ExecutionData, unit::Symbol=:bps)\n\nRetrieve slippage summary in the specified unit.\n\nArguments\n\nexec_data: ExecutionData with slippage already calculated via calculate_slippage!\nunit: One of :bps (basis points), :pct (percentage points), or :usd (dollar value)\n\nReturns\n\nDataFrame with slippage metrics in the requested unit\n\n\n\n\n\n","category":"function"},{"location":"api/#Visualization-and-Reporting","page":"API","title":"Visualization and Reporting","text":"","category":"section"},{"location":"api/","page":"API","title":"API","text":"print_slippage_summary\nplot_execution_markout","category":"page"},{"location":"api/#RefinedSlippage.print_slippage_summary","page":"API","title":"RefinedSlippage.print_slippage_summary","text":"print_slippage_summary(exec_data::ExecutionData; unit::Symbol=:bps)\n\nPrint a formatted summary of slippage statistics across all executions.\n\nArguments\n\nexec_data: ExecutionData with slippage already calculated\nunit: One of :bps (basis points), :pct (percentage), or :usd (dollar value)\n\nOutput\n\nPrints mean and standard deviation of classical slippage (and refined/vs_vwap if available).\n\n\n\n\n\n","category":"function"},{"location":"api/#RefinedSlippage.plot_execution_markout","page":"API","title":"RefinedSlippage.plot_execution_markout","text":"plot_execution_markout(exec_data::ExecutionData, execution_name::String;\n                      window_before::Real=0, window_after::Real=0)\n\nCreate a two-panel VegaLite visualization for a single execution:\n\nTop panel: Price markout showing bid/ask lines and fill prices\nBottom panel: Cumulative classical and refined slippage over time\n\nArguments\n\nexec_data: ExecutionData with slippage already calculated\nexecution_name: Name of the execution to visualize\nwindow_before: Time to show before first fill (default: 0)\nwindow_after: Time to show after last fill (default: 0)\n\nReturns\n\nVegaLite plot specification\n\n\n\n\n\n","category":"function"},{"location":"Examples/#Examples","page":"Examples","title":"Examples","text":"","category":"section"},{"location":"Examples/#Basic-Usage-with-Classical-Slippage","page":"Examples","title":"Basic Usage with Classical Slippage","text":"","category":"section"},{"location":"Examples/","page":"Examples","title":"Examples","text":"To calculate classical slippage without peer adjustments:","category":"page"},{"location":"Examples/","page":"Examples","title":"Examples","text":"using RefinedSlippage, DataFrames\n\n# Fill data: time, quantity, price for each execution\nfills = DataFrame(\n    time = [1.0, 2.0, 3.0],\n    quantity = [100, 150, 100],\n    price = [101.0, 101.5, 102.0],\n    execution_name = [\"buy_AAPL\", \"buy_AAPL\", \"buy_AAPL\"],\n    asset = [:AAPL, :AAPL, :AAPL]\n)\n\n# Metadata for each execution\nmetadata = DataFrame(\n    execution_name = [\"buy_AAPL\"],\n    arrival_price = [100.0],\n    side = [\"buy\"],\n    desired_quantity = [350]\n)\n\n# Top of book data\ntob = DataFrame(\n    time = [1.0, 2.0, 3.0],\n    symbol = [:AAPL, :AAPL, :AAPL],\n    bid_price = [99.5, 100.5, 101.0],\n    ask_price = [100.5, 101.5, 102.0]\n)\n\n# Create ExecutionData and calculate slippage\nexec_data = ExecutionData(fills, metadata, tob)\ncalculate_slippage!(exec_data)\n\n# View results\nprint_slippage_summary(exec_data)","category":"page"},{"location":"Examples/#Refined-Slippage-with-Peer-Assets","page":"Examples","title":"Refined Slippage with Peer Assets","text":"","category":"section"},{"location":"Examples/","page":"Examples","title":"Examples","text":"To use refined slippage with automatic peer selection:","category":"page"},{"location":"Examples/","page":"Examples","title":"Examples","text":"using RefinedSlippage, DataFrames, HighFrequencyCovariance\n\n# Create covariance matrix from time series data\n# (assuming you have TimeseriesData from HighFrequencyCovariance.jl)\ncovar = CovarianceMatrix(timeseries_data)\n\n# ExecutionData with peer-based adjustment\nexec_data = ExecutionData(\n    fills,\n    metadata,\n    tob,\n    covar;\n    num_peers = 5,                    # Use top 5 correlated peers\n    peer_return_truncation = 2.0      # Truncate peer returns at ±2σ\n)\n\ncalculate_slippage!(exec_data)\n\n# Summary now includes both classical and refined slippage\nprint_slippage_summary(exec_data, unit=:bps)","category":"page"},{"location":"Examples/#Visualization","page":"Examples","title":"Visualization","text":"","category":"section"},{"location":"Examples/","page":"Examples","title":"Examples","text":"To plot execution markout for a specific execution:","category":"page"},{"location":"Examples/","page":"Examples","title":"Examples","text":"# Create plot showing price path and cumulative slippage\nplot = plot_execution_markout(\n    exec_data,\n    \"buy_AAPL\",\n    window_before = 5.0,    # Show 5 time units before first fill\n    window_after = 10.0     # Show 10 time units after last fill\n)\n\n# Save or display the plot\nusing VegaLite\nsave(\"execution_markout.png\", plot)","category":"page"},{"location":"Examples/","page":"Examples","title":"Examples","text":"The plot shows:","category":"page"},{"location":"Examples/","page":"Examples","title":"Examples","text":"Top panel: bid/ask prices, arrival price, counterfactual price (if peers available), and fill points\nBottom panel: cumulative classical, refined, and vs VWAP slippage over the execution","category":"page"},{"location":"Examples/#Vs-VWAP-Slippage","page":"Examples","title":"Vs VWAP Slippage","text":"","category":"section"},{"location":"Examples/","page":"Examples","title":"Examples","text":"To calculate vs VWAP slippage, provide market volume data with time intervals:","category":"page"},{"location":"Examples/","page":"Examples","title":"Examples","text":"# Market volume data: total volume in each interval\nvolume = DataFrame(\n    time_from = [1.0, 1.5, 2.0, 2.5],\n    time_to = [1.5, 2.0, 2.5, 3.0],\n    symbol = [:AAPL, :AAPL, :AAPL, :AAPL],\n    volume = [1000, 500, 800, 1200]\n)\n\n# Create ExecutionData with volume\nexec_data = ExecutionData(fills, metadata, tob; volume=volume)\ncalculate_slippage!(exec_data)\n\n# Summary now includes vs VWAP slippage\nprint_slippage_summary(exec_data)","category":"page"},{"location":"Examples/","page":"Examples","title":"Examples","text":"Market VWAP is estimated using TOB mid-prices weighted by the volume in each interval.","category":"page"},{"location":"Examples/","page":"Examples","title":"Examples","text":"You can combine volume data with peer data to get all three metrics:","category":"page"},{"location":"Examples/","page":"Examples","title":"Examples","text":"exec_data = ExecutionData(\n    fills, metadata, tob, covar;\n    volume = volume,\n    num_peers = 5,\n    peer_return_truncation = 2.0\n)","category":"page"},{"location":"Examples/#Manual-Peer-Weights","page":"Examples","title":"Manual Peer Weights","text":"","category":"section"},{"location":"Examples/","page":"Examples","title":"Examples","text":"If you want to specify peer weights directly:","category":"page"},{"location":"Examples/","page":"Examples","title":"Examples","text":"# Define custom peer weights\npeer_weights = Dict(:SPY => 0.6, :QQQ => 0.4)\n\n# Optional: provide volatilities for return truncation\nvols = Dict(:AAPL => 0.02, :SPY => 0.015, :QQQ => 0.025)\n\nexec_data = ExecutionData(fills, metadata, tob, peer_weights, vols)\ncalculate_slippage!(exec_data)","category":"page"},{"location":"#Overview","page":"Overview","title":"Overview","text":"","category":"section"},{"location":"","page":"Overview","title":"Overview","text":"RefinedSlippage.jl measures execution slippage - the difference between arrival price and actual fill prices. It computes classical slippage (raw price impact), refined slippage (market-adjusted using peer assets), and vs VWAP slippage (compared to market VWAP).","category":"page"},{"location":"#Slippage-Metrics","page":"Overview","title":"Slippage Metrics","text":"","category":"section"},{"location":"#Classical-Slippage","page":"Overview","title":"Classical Slippage","text":"","category":"section"},{"location":"","page":"Overview","title":"Overview","text":"Classical slippage measures the direct cost of execution relative to the arrival price:","category":"page"},{"location":"","page":"Overview","title":"Overview","text":"textClassical Slippage = fracsum (p_i - p_0) q_isum q_i cdot p_0","category":"page"},{"location":"","page":"Overview","title":"Overview","text":"where p_i is the fill price, p_0 is the arrival price, and q_i is the fill quantity.","category":"page"},{"location":"#Refined-Slippage","page":"Overview","title":"Refined Slippage","text":"","category":"section"},{"location":"","page":"Overview","title":"Overview","text":"Refined slippage adjusts for market movements by constructing a counterfactual price from correlated peer assets:","category":"page"},{"location":"","page":"Overview","title":"Overview","text":"textRefined Slippage = fracsum (p_i - hatp_i) q_isum q_i cdot p_0","category":"page"},{"location":"","page":"Overview","title":"Overview","text":"where hatp_i is the counterfactual price based on peer asset returns.","category":"page"},{"location":"","page":"Overview","title":"Overview","text":"The peer weights are determined by bilateral correlations from a covariance matrix. Returns from peer assets can be truncated at a specified number of standard deviations to reduce the impact of outliers.","category":"page"},{"location":"#Vs-VWAP-Slippage","page":"Overview","title":"Vs VWAP Slippage","text":"","category":"section"},{"location":"","page":"Overview","title":"Overview","text":"Vs VWAP slippage compares your execution VWAP to the market VWAP during the order:","category":"page"},{"location":"","page":"Overview","title":"Overview","text":"textVs VWAP Slippage = fractextFill VWAP - textMarket VWAPp_0","category":"page"},{"location":"","page":"Overview","title":"Overview","text":"This requires providing market volume data (all trades, not just your fills) during the execution window.","category":"page"},{"location":"#Main-Components","page":"Overview","title":"Main Components","text":"","category":"section"},{"location":"","page":"Overview","title":"Overview","text":"ExecutionData - Container for execution fills, metadata, bid/ask data, and optional covariance matrix for peer selection\ncalculate_slippage! - Calculates classical and refined slippage for all executions\nprint_slippage_summary - Prints summary statistics\nplot_execution_markout - Visualizes execution price paths and cumulative slippage","category":"page"},{"location":"#Peer-Selection","page":"Overview","title":"Peer Selection","text":"","category":"section"},{"location":"","page":"Overview","title":"Overview","text":"When a covariance matrix is provided, the package selects peer assets with the highest bilateral correlation to the traded asset. The num_peers parameter controls how many peers to use.","category":"page"},{"location":"","page":"Overview","title":"Overview","text":"Peer returns can also be truncated at peer_return_truncation standard deviations (default 2.0) so your counterfactual price and refined slippage is not too impacted by extreme events.","category":"page"}]
}
